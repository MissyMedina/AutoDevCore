<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoDevCore Thought Trail Visualization</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        .content {
            padding: 30px;
        }
        .section {
            margin-bottom: 40px;
            padding: 20px;
            border-radius: 10px;
            background: #f8f9fa;
            border-left: 4px solid #667eea;
        }
        .section h2 {
            color: #333;
            margin-top: 0;
            font-size: 1.5em;
        }
        .timeline {
            position: relative;
            padding-left: 30px;
        }
        .timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #667eea;
        }
        .timeline-item {
            position: relative;
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -22px;
            top: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #667eea;
            border: 3px solid white;
        }
        .timeline-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .agent {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1em;
        }
        .timestamp {
            color: #666;
            font-size: 0.9em;
        }
        .thought {
            color: #333;
            line-height: 1.5;
        }
        .data-preview {
            margin-top: 10px;
            padding: 10px;
            background: #f1f3f4;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.9em;
            color: #555;
            max-height: 100px;
            overflow-y: auto;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        .stat-label {
            color: #666;
            margin-top: 5px;
        }
        .controls {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }
        .btn-primary {
            background: #667eea;
            color: white;
        }
        .btn-primary:hover {
            background: #5a6fd8;
        }
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        .btn-secondary:hover {
            background: #5a6268;
        }
        .filter-section {
            margin-bottom: 20px;
        }
        .filter-section label {
            margin-right: 10px;
            font-weight: bold;
        }
        .filter-section select {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .mermaid-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ AutoDevCore Thought Trail</h1>
            <p>Visualizing AI Agent Reasoning and Decision Making</p>
        </div>
        
        <div class="content">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="total-thoughts">0</div>
                    <div class="stat-label">Total Thoughts</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="unique-agents">0</div>
                    <div class="stat-label">Unique Agents</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="avg-thought-length">0</div>
                    <div class="stat-label">Avg Thought Length</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="analysis-duration">0s</div>
                    <div class="stat-label">Analysis Duration</div>
                </div>
            </div>
            
            <div class="section">
                <h2>üéõÔ∏è Controls & Filters</h2>
                <div class="controls">
                    <button class="btn btn-primary" onclick="exportToJSON()">Export JSON</button>
                    <button class="btn btn-secondary" onclick="exportToCSV()">Export CSV</button>
                    <button class="btn btn-secondary" onclick="toggleDataPreview()">Toggle Data Preview</button>
                </div>
                <div class="filter-section">
                    <label>Filter by Agent:</label>
                    <select id="agent-filter" onchange="filterByAgent()">
                        <option value="">All Agents</option>
                    </select>
                </div>
            </div>
            
            <div class="section">
                <h2>üìä Agent Activity Chart</h2>
                <canvas id="agentChart" width="400" height="200"></canvas>
            </div>
            
            <div class="section">
                <h2>üïí Timeline View</h2>
                <div class="timeline" id="timeline">
                    <!-- Timeline items will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="section">
                <h2>üîó Thought Flow Diagram</h2>
                <div class="mermaid-container">
                    <div class="mermaid" id="mermaid-diagram">
                        <!-- Mermaid diagram will be rendered here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize thought trail data
        const thoughtTrail = [
  {
    "timestamp": "2025-08-10T01:19:41.989030",
    "agent": "Composer",
    "thought": "Starting app idea analysis",
    "data": {
      "idea": "secure task management app with user authentication"
    },
    "id": 0
  },
  {
    "timestamp": "2025-08-10T01:24:42.062420",
    "agent": "Composer",
    "thought": "App plan created",
    "data": {
      "plan": {
        "error": "Plan generation failed: Request timed out - model may be too slow or overloaded"
      }
    },
    "id": 1
  },
  {
    "timestamp": "2025-08-10T01:24:42.063488",
    "agent": "PRD Writer",
    "thought": "Starting PRD generation",
    "data": {},
    "id": 2
  },
  {
    "timestamp": "2025-08-10T01:24:42.070895",
    "agent": "PRD Writer",
    "thought": "PRD generated successfully",
    "data": {},
    "id": 3
  },
  {
    "timestamp": "2025-08-10T01:24:42.070907",
    "agent": "Code Generator",
    "thought": "Starting code generation",
    "data": {},
    "id": 4
  },
  {
    "timestamp": "2025-08-10T01:24:42.082564",
    "agent": "Code Generator",
    "thought": "Codebase generated",
    "data": {
      "files": [
        "main.py",
        "models.py",
        "database.py",
        "api/routes.py",
        "api/__init__.py",
        "utils/helpers.py",
        "utils/__init__.py",
        "tests/test_main.py",
        "tests/__init__.py",
        "config.py",
        "requirements.txt",
        ".env.example",
        "Dockerfile",
        ".gitignore",
        "auth/auth.py",
        "auth/models.py",
        "auth/dependencies.py",
        "middleware/security.py",
        "config/security.py",
        "utils/validation.py",
        "requirements_security.txt"
      ]
    },
    "id": 5
  },
  {
    "timestamp": "2025-08-10T01:24:42.082625",
    "agent": "README Writer",
    "thought": "Starting README generation",
    "data": {},
    "id": 6
  },
  {
    "timestamp": "2025-08-10T01:24:42.083752",
    "agent": "README Writer",
    "thought": "README generated successfully",
    "data": {},
    "id": 7
  }
];
        
        // Initialize Mermaid
        mermaid.initialize({ startOnLoad: true });
        
        // Calculate statistics
        function calculateStats() {
            const totalThoughts = thoughtTrail.length;
            const uniqueAgents = new Set(thoughtTrail.map(t => t.agent)).size;
            const avgLength = Math.round(thoughtTrail.reduce((sum, t) => sum + t.thought.length, 0) / totalThoughts);
            
            // Calculate duration
            const firstTime = new Date(thoughtTrail[0].timestamp);
            const lastTime = new Date(thoughtTrail[thoughtTrail.length - 1].timestamp);
            const duration = Math.round((lastTime - firstTime) / 1000);
            
            document.getElementById('total-thoughts').textContent = totalThoughts;
            document.getElementById('unique-agents').textContent = uniqueAgents;
            document.getElementById('avg-thought-length').textContent = avgLength;
            document.getElementById('analysis-duration').textContent = duration + 's';
        }
        
        // Populate agent filter
        function populateAgentFilter() {
            const agents = [...new Set(thoughtTrail.map(t => t.agent))];
            const select = document.getElementById('agent-filter');
            
            agents.forEach(agent => {
                const option = document.createElement('option');
                option.value = agent;
                option.textContent = agent;
                select.appendChild(option);
            });
        }
        
        // Render timeline
        function renderTimeline(filteredTrail = thoughtTrail) {
            const timeline = document.getElementById('timeline');
            timeline.innerHTML = '';
            
            filteredTrail.forEach(thought => {
                const item = document.createElement('div');
                item.className = 'timeline-item';
                
                const timestamp = new Date(thought.timestamp).toLocaleTimeString();
                const dataPreview = thought.data && Object.keys(thought.data).length > 0 
                    ? `<div class="data-preview">Data: ${JSON.stringify(thought.data).substring(0, 100)}...</div>`
                    : '';
                
                item.innerHTML = `
                    <div class="timeline-header">
                        <span class="agent">${thought.agent}</span>
                        <span class="timestamp">${timestamp}</span>
                    </div>
                    <div class="thought">${thought.thought}</div>
                    ${dataPreview}
                `;
                
                timeline.appendChild(item);
            });
        }
        
        // Create agent activity chart
        function createAgentChart() {
            const ctx = document.getElementById('agentChart').getContext('2d');
            const agentCounts = {};
            
            thoughtTrail.forEach(thought => {
                agentCounts[thought.agent] = (agentCounts[thought.agent] || 0) + 1;
            });
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(agentCounts),
                    datasets: [{
                        label: 'Thoughts per Agent',
                        data: Object.values(agentCounts),
                        backgroundColor: [
                            '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4',
                            '#FFEAA7', '#DDA0DD', '#98D8C8', '#F7DC6F'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
        
        // Filter by agent
        function filterByAgent() {
            const selectedAgent = document.getElementById('agent-filter').value;
            const filteredTrail = selectedAgent 
                ? thoughtTrail.filter(t => t.agent === selectedAgent)
                : thoughtTrail;
            
            renderTimeline(filteredTrail);
        }
        
        // Export functions
        function exportToJSON() {
            const dataStr = JSON.stringify(thoughtTrail, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'thought_trail.json';
            link.click();
        }
        
        function exportToCSV() {
            const headers = ['Timestamp', 'Agent', 'Thought', 'Data'];
            const csvContent = [
                headers.join(','),
                ...thoughtTrail.map(t => [
                    t.timestamp,
                    t.agent,
                    `"${t.thought.replace(/"/g, '""')}"`,
                    `"${JSON.stringify(t.data).replace(/"/g, '""')}"`
                ].join(','))
            ].join('\n');
            
            const dataBlob = new Blob([csvContent], {type: 'text/csv'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'thought_trail.csv';
            link.click();
        }
        
        // Toggle data preview
        function toggleDataPreview() {
            const previews = document.querySelectorAll('.data-preview');
            previews.forEach(preview => {
                preview.style.display = preview.style.display === 'none' ? 'block' : 'none';
            });
        }
        
        // Initialize everything
        document.addEventListener('DOMContentLoaded', function() {
            calculateStats();
            populateAgentFilter();
            renderTimeline();
            createAgentChart();
        });
    </script>
</body>
</html>